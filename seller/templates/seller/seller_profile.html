{% extends 'index.html' %}

{% block title %}{{ seller.shop_name }} - Profile{% endblock %}
{% block content %}

{% block extra_css %}
<style>
/* Override base template styles */
.seller-profile-page {
  --primary-blue: #3B82F6;
  --primary-blue-dark: #2563EB;
  --primary-blue-light: #EFF6FF;
  --success-green: #10B981;
  --warning-yellow: #F59E0B;
  --error-red: #EF4444;
  --text-primary: #1F2937;
  --text-secondary: #6B7280;
  --text-muted: #9CA3AF;
  --bg-primary: #FFFFFF;
  --bg-secondary: #F9FAFB;
  --bg-tertiary: #F3F4F6;
  --border-light: #E5E7EB;
  --border-medium: #D1D5DB;
  --border-dark: #9CA3AF;
  --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
  --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
  --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
  --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
  --radius-sm: 0.375rem;
  --radius-md: 0.5rem;
  --radius-lg: 0.75rem;
  --radius-xl: 1rem;
  --radius-2xl: 1.5rem;
  --radius-full: 9999px;
}

/* Reset and override base template styles */
.seller-profile-page * {
  box-sizing: border-box;
}

.seller-profile-page {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif !important;
  line-height: 1.6;
  color: var(--text-primary);
  background: var(--bg-secondary);
  margin: 0;
  padding: 0;
  min-height: 100vh;
}

/* Hide navbar and footer when using extend block */
.seller-profile-page header,
.seller-profile-page nav,
.seller-profile-page footer {
  display: none !important;
}

/* Fix SVG sizing issues */
.seller-profile-page svg {
  max-width: 100% !important;
  height: auto !important;
  width: auto !important;
}

/* Profile Container */
.seller-profile-page .profile-container {
  max-width: 1400px;
  margin: 0 auto;
  padding: 1.5rem;
  min-height: 100vh;
  background: var(--bg-secondary);
}

/* Profile Header */
.seller-profile-page .profile-header {
  background: linear-gradient(135deg, var(--primary-blue) 0%, var(--primary-blue-dark) 100%);
  border-radius: var(--radius-xl);
  padding: 2.5rem;
  margin-bottom: 2rem;
  box-shadow: var(--shadow-xl);
  position: relative;
  overflow: hidden;
}

.seller-profile-page .profile-header::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="25" cy="25" r="1" fill="rgba(255,255,255,0.1)"/><circle cx="75" cy="75" r="1" fill="rgba(255,255,255,0.1)"/><circle cx="50" cy="10" r="0.5" fill="rgba(255,255,255,0.1)"/><circle cx="10" cy="60" r="0.5" fill="rgba(255,255,255,0.1)"/><circle cx="90" cy="40" r="0.5" fill="rgba(255,255,255,0.1)"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>');
  opacity: 0.3;
}

.seller-profile-page .profile-header-content {
  display: grid;
  grid-template-columns: auto 1fr auto;
  gap: 2.5rem;
  align-items: center;
  position: relative;
  z-index: 1;
}

/* Profile Avatar */
.seller-profile-page .profile-avatar {
  position: relative;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 1rem;
}

.seller-profile-page .avatar-container {
  position: relative;
  width: 140px;
  height: 140px;
  border-radius: var(--radius-full);
  overflow: hidden;
  border: 5px solid rgba(255, 255, 255, 0.3);
  background: rgba(255, 255, 255, 0.1);
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: var(--shadow-lg);
  transition: all 0.3s ease;
}

.seller-profile-page .avatar-container:hover {
  transform: scale(1.05);
  border-color: rgba(255, 255, 255, 0.5);
}

.seller-profile-page .avatar-image {
  width: 100%;
  height: 100%;
  object-fit: cover;
  transition: transform 0.3s ease;
}

.seller-profile-page .avatar-container:hover .avatar-image {
  transform: scale(1.1);
}

.seller-profile-page .avatar-placeholder {
  font-size: 3.5rem;
  color: rgba(255, 255, 255, 0.8);
  text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

/* Profile Info */
.seller-profile-page .profile-info {
  flex: 1;
  color: white;
}

.seller-profile-page .profile-info h1 {
  font-size: 2.5rem;
  font-weight: 800;
  margin: 0 0 0.5rem 0;
  text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  letter-spacing: -0.025em;
}

.seller-profile-page .profile-info .subtitle {
  font-size: 1.25rem;
  margin-bottom: 1.5rem;
  opacity: 0.9;
  font-weight: 500;
}

.seller-profile-page .profile-meta {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
  gap: 1.25rem;
}

.seller-profile-page .meta-item {
  display: flex;
  align-items: center;
  gap: 0.75rem;
  font-size: 0.95rem;
  opacity: 0.9;
  padding: 0.75rem;
  background: rgba(255, 255, 255, 0.1);
  border-radius: var(--radius-md);
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
}

.seller-profile-page .meta-item:hover {
  background: rgba(255, 255, 255, 0.15);
  transform: translateY(-2px);
}

.seller-profile-page .meta-icon {
  width: 1.25rem;
  height: 1.25rem;
  opacity: 0.8;
  flex-shrink: 0;
}

/* Profile Actions */
.seller-profile-page .profile-actions {
  display: flex;
  flex-direction: column;
  gap: 1rem;
  align-items: flex-end;
}

/* Main Content Grid */
.seller-profile-page .main-content {
  display: grid;
  grid-template-columns: 1fr 350px;
  gap: 2rem;
  align-items: start;
}

/* Form Section */
.seller-profile-page .profile-form-section {
  background: var(--bg-primary);
  border-radius: var(--radius-xl);
  border: 1px solid var(--border-light);
  overflow: hidden;
  box-shadow: var(--shadow-lg);
  transition: all 0.3s ease;
}

.seller-profile-page .profile-form-section:hover {
  box-shadow: var(--shadow-xl);
  transform: translateY(-2px);
}

.seller-profile-page .form-section-header {
  background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-tertiary) 100%);
  padding: 2rem;
  border-bottom: 1px solid var(--border-light);
  position: relative;
}

.seller-profile-page .form-section-header::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 3px;
  background: linear-gradient(90deg, var(--primary-blue) 0%, var(--success-green) 50%, var(--warning-yellow) 100%);
}

.seller-profile-page .form-section-header h2 {
  font-size: 1.5rem;
  font-weight: 700;
  color: var(--text-primary);
  margin: 0;
  display: flex;
  align-items: center;
  gap: 0.75rem;
}

.seller-profile-page .form-section-header h2::before {
  content: 'ðŸ‘¤';
  font-size: 1.25rem;
}

.seller-profile-page .form-section-body {
  padding: 2.5rem;
}

/* Form Grid */
.seller-profile-page .form-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 2rem;
}

.seller-profile-page .form-grid .form-group.full-width {
  grid-column: 1 / -1;
}

/* Form Groups */
.seller-profile-page .form-group {
  position: relative;
}

.seller-profile-page .form-label {
  display: block;
  font-weight: 600;
  color: var(--text-primary);
  margin-bottom: 0.75rem;
  font-size: 0.95rem;
  position: relative;
}

.form-label::after {
  content: '';
  position: absolute;
  bottom: -2px;
  left: 0;
  width: 0;
  height: 2px;
  background: var(--primary-blue);
  transition: width 0.3s ease;
}

.form-group:focus-within .form-label::after {
  width: 100%;
}

.seller-profile-page .form-input, 
.seller-profile-page .form-textarea {
  width: 100%;
  padding: 1rem 1.25rem;
  border: 2px solid var(--border-light);
  border-radius: var(--radius-md);
  font-size: 1rem;
  transition: all 0.3s ease;
  background: var(--bg-primary);
  color: var(--text-primary);
  font-family: inherit;
}

.form-input:focus, .form-textarea:focus {
  outline: none;
  border-color: var(--primary-blue);
  box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
  transform: translateY(-1px);
}

.form-input:disabled {
  background: var(--bg-tertiary);
  color: var(--text-muted);
  cursor: not-allowed;
  border-color: var(--border-medium);
}

.form-textarea {
  resize: vertical;
  min-height: 120px;
}

/* Image Upload Section */
.image-upload-section {
  grid-column: 1 / -1;
  border: 3px dashed var(--border-medium);
  border-radius: var(--radius-lg);
  padding: 3rem 2rem;
  text-align: center;
  transition: all 0.3s ease;
  background: var(--bg-secondary);
  position: relative;
  overflow: hidden;
}

.image-upload-section::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(45deg, transparent 30%, rgba(59, 130, 246, 0.05) 50%, transparent 70%);
  transform: translateX(-100%);
  transition: transform 0.6s ease;
}

.image-upload-section:hover::before {
  transform: translateX(100%);
}

.image-upload-section:hover {
  border-color: var(--primary-blue);
  background: var(--primary-blue-light);
  transform: scale(1.02);
}

.image-upload-section.drag-over {
  border-color: var(--primary-blue);
  background: var(--primary-blue-light);
  transform: scale(1.02);
  box-shadow: 0 0 0 6px rgba(59, 130, 246, 0.1);
}

.upload-content svg {
  margin: 0 auto 1.5rem;
  color: var(--text-muted);
  transition: all 0.3s ease;
}

.image-upload-section:hover .upload-content svg {
  color: var(--primary-blue);
  transform: scale(1.1);
}

.upload-preview {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 2rem;
  margin-top: 1.5rem;
  padding: 1.5rem;
  background: rgba(255, 255, 255, 0.8);
  border-radius: var(--radius-lg);
  backdrop-filter: blur(10px);
}

.preview-container {
  position: relative;
}

.preview-image {
  width: 120px;
  height: 120px;
  border-radius: var(--radius-full);
  object-fit: cover;
  border: 4px solid var(--primary-blue);
  box-shadow: var(--shadow-md);
  transition: all 0.3s ease;
}

.preview-image:hover {
  transform: scale(1.05);
  box-shadow: var(--shadow-lg);
}

.remove-preview {
  position: absolute;
  top: -8px;
  right: -8px;
  background: var(--error-red);
  color: white;
  border: none;
  width: 28px;
  height: 28px;
  border-radius: var(--radius-full);
  cursor: pointer;
  font-size: 14px;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: var(--shadow-md);
  transition: all 0.3s ease;
}

.remove-preview:hover {
  background: #DC2626;
  transform: scale(1.1);
}

/* Sidebar */
.seller-profile-page .sidebar {
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
  position: sticky;
  top: 2rem;
}

.seller-profile-page .sidebar-card {
  background: var(--bg-primary);
  border-radius: var(--radius-xl);
  border: 1px solid var(--border-light);
  overflow: hidden;
  box-shadow: var(--shadow-md);
  transition: all 0.3s ease;
}

.seller-profile-page .sidebar-card:hover {
  box-shadow: var(--shadow-lg);
  transform: translateY(-2px);
}

.seller-profile-page .sidebar-card-header {
  background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-tertiary) 100%);
  padding: 1.5rem;
  border-bottom: 1px solid var(--border-light);
  position: relative;
}

.seller-profile-page .sidebar-card-header::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 2px;
  background: var(--primary-blue);
}

.seller-profile-page .sidebar-card-header h3 {
  font-size: 1.125rem;
  font-weight: 700;
  color: var(--text-primary);
  margin: 0;
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.seller-profile-page .sidebar-card-body {
  padding: 1.5rem;
}

/* Stats */
.seller-profile-page .stat-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 1rem 0;
  border-bottom: 1px solid var(--border-light);
  transition: all 0.3s ease;
}

.seller-profile-page .stat-item:hover {
  background: var(--bg-secondary);
  margin: 0 -1.5rem;
  padding: 1rem 1.5rem;
  border-radius: var(--radius-md);
}

.seller-profile-page .stat-item:last-child {
  border-bottom: none;
}

.seller-profile-page .stat-label {
  color: var(--text-secondary);
  font-size: 0.9rem;
  font-weight: 500;
}

.seller-profile-page .stat-value {
  font-weight: 700;
  color: var(--text-primary);
  font-size: 1.1rem;
}

/* Toggle Switch */
.toggle-switch {
  position: relative;
  display: inline-block;
  width: 52px;
  height: 28px;
}

.toggle-switch input {
  opacity: 0;
  width: 0;
  height: 0;
}

.toggle-slider {
  position: absolute;
  cursor: pointer;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: var(--border-medium);
  transition: 0.3s ease;
  border-radius: var(--radius-full);
  box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
}

.toggle-slider:before {
  position: absolute;
  content: "";
  height: 22px;
  width: 22px;
  left: 3px;
  bottom: 3px;
  background-color: white;
  transition: 0.3s ease;
  border-radius: var(--radius-full);
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
}

input:checked + .toggle-slider {
  background-color: var(--primary-blue);
}

input:checked + .toggle-slider:before {
  transform: translateX(24px);
}

/* Privacy Settings */
.privacy-setting {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 1.25rem 0;
  border-bottom: 1px solid var(--border-light);
  transition: all 0.3s ease;
}

.privacy-setting:hover {
  background: var(--bg-secondary);
  margin: 0 -1.5rem;
  padding: 1.25rem 1.5rem;
  border-radius: var(--radius-md);
}

.privacy-setting:last-child {
  border-bottom: none;
}

.privacy-label {
  flex: 1;
  margin-right: 1rem;
}

.privacy-title {
  font-weight: 600;
  color: var(--text-primary);
  margin-bottom: 0.25rem;
  font-size: 0.95rem;
}

.privacy-description {
  font-size: 0.85rem;
  color: var(--text-secondary);
  line-height: 1.4;
}

/* Form Actions */
.seller-profile-page .form-actions {
  display: flex;
  gap: 1rem;
  justify-content: flex-end;
  padding-top: 2rem;
  border-top: 1px solid var(--border-light);
  margin-top: 2rem;
}

/* Buttons */
.seller-profile-page .btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 0.5rem;
  padding: 0.875rem 1.5rem;
  border-radius: var(--radius-md);
  font-weight: 600;
  font-size: 0.95rem;
  text-decoration: none;
  border: none;
  cursor: pointer;
  transition: all 0.3s ease;
  position: relative;
  overflow: hidden;
  white-space: nowrap;
  min-height: 44px;
}

.btn::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
  transition: left 0.5s ease;
}

.btn:hover::before {
  left: 100%;
}

.seller-profile-page .btn-primary {
  background: linear-gradient(135deg, var(--primary-blue) 0%, var(--primary-blue-dark) 100%);
  color: white;
  box-shadow: var(--shadow-md);
}

.seller-profile-page .btn-primary:hover {
  transform: translateY(-2px);
  box-shadow: var(--shadow-lg);
}

.seller-profile-page .btn-secondary {
  background: var(--bg-secondary);
  color: var(--text-primary);
  border: 2px solid var(--border-medium);
}

.seller-profile-page .btn-secondary:hover {
  background: var(--bg-tertiary);
  border-color: var(--border-dark);
  transform: translateY(-1px);
}

.seller-profile-page .btn-ghost {
  background: transparent;
  color: var(--text-secondary);
  border: 2px solid transparent;
}

.seller-profile-page .btn-ghost:hover {
  background: var(--bg-secondary);
  color: var(--text-primary);
  border-color: var(--border-light);
}

/* Alert Messages */
.seller-profile-page .alert {
  padding: 0.75rem 1rem;
  border-radius: var(--radius-md);
  margin: 1rem auto 1.5rem auto;
  max-width: 200px;
  max-height: 50px;
  border: 1px solid;
  display: flex;
  align-items: center;
  gap: 0.5rem;
      font-weight: 100;
    font-size: 1rem;
  box-shadow: var(--shadow-sm);
  animation: slideInDown 0.3s ease;
  text-align: center;
  justify-content: center;
}

@keyframes slideInDown {
  from {
    opacity: 0;
    transform: translateY(-20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.seller-profile-page .alert-success {
  background: linear-gradient(135deg, #F0FDF4 0%, #DCFCE7 100%);
  border-color: var(--success-green);
  color: #166534;
}

.seller-profile-page .alert-error {
  background: linear-gradient(135deg, #FEF2F2 0%, #FEE2E2 100%);
  border-color: var(--error-red);
  color: #991B1B;
}

.seller-profile-page .alert .alert-icon {
  width: 2.5rem !important;
  height: 2.5rem !important;
  flex-shrink: 0;
  max-width: 2.5rem !important;
  max-height: 2.5rem !important;
}

/* Form Error States */
.form-error {
  color: var(--error-red);
  font-size: 0.85rem;
  margin-top: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;
  animation: shake 0.5s ease;
}

@keyframes shake {
  0%, 100% { transform: translateX(0); }
  25% { transform: translateX(-5px); }
  75% { transform: translateX(5px); }
}

.form-input.invalid {
  border-color: var(--error-red);
  box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.1);
}

/* Loading State */
.btn.loading {
  position: relative;
  color: transparent;
  pointer-events: none;
}

.btn.loading::after {
  content: "";
  position: absolute;
  width: 18px;
  height: 18px;
  top: 50%;
  left: 50%;
  margin-left: -9px;
  margin-top: -9px;
  border: 2px solid transparent;
  border-top-color: currentColor;
  border-radius: 50%;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}

/* Responsive Design */
@media (max-width: 1200px) {
  .profile-container {
    max-width: 100%;
    padding: 1rem;
  }
  
  .main-content {
    grid-template-columns: 1fr 320px;
    gap: 1.5rem;
  }
  
  .profile-header-content {
    gap: 2rem;
  }
  
  .avatar-container {
    width: 120px;
    height: 120px;
  }
  
  .profile-info h1 {
    font-size: 2rem;
  }
}

@media (max-width: 1024px) {
  .main-content {
    grid-template-columns: 1fr;
    gap: 1.5rem;
  }
  
  .sidebar {
    order: -1;
    position: static;
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 1rem;
  }
  
  .sidebar-card {
    margin-bottom: 0;
  }
  
  .profile-meta {
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  }
}

@media (max-width: 768px) {
  .profile-container {
    padding: 0.75rem;
  }
  
  .profile-header {
    padding: 2rem 1.5rem;
    margin-bottom: 1.5rem;
  }
  
  .profile-header-content {
    grid-template-columns: 1fr;
    gap: 1.5rem;
    text-align: center;
  }
  
  .profile-actions {
    flex-direction: row;
    justify-content: center;
    flex-wrap: wrap;
  }
  
  .avatar-container {
    width: 100px;
    height: 100px;
    margin: 0 auto;
  }
  
  .profile-info h1 {
    font-size: 1.75rem;
  }
  
  .profile-info .subtitle {
    font-size: 1.125rem;
  }
  
  .profile-meta {
    grid-template-columns: 1fr;
    gap: 1rem;
  }
  
  .meta-item {
    justify-content: center;
  }
  
  .form-section-body {
    padding: 1.5rem;
  }
  
  .form-grid {
    grid-template-columns: 1fr;
    gap: 1.5rem;
  }
  
  .form-actions {
    flex-direction: column;
    gap: 0.75rem;
  }
  
  .btn {
    width: 100%;
    justify-content: center;
  }
  
  .image-upload-section {
    padding: 2rem 1rem;
  }
  
  .upload-preview {
    flex-direction: column;
    gap: 1rem;
    text-align: center;
  }
  
  .preview-image {
    width: 100px;
    height: 100px;
  }
  
  .sidebar {
    grid-template-columns: 1fr;
  }
}

@media (max-width: 480px) {
  .profile-container {
    padding: 0.5rem;
  }
  
  .profile-header {
    padding: 1.5rem 1rem;
    border-radius: var(--radius-lg);
  }
  
  .profile-header-content {
    gap: 1rem;
  }
  
  .avatar-container {
    width: 80px;
    height: 80px;
  }
  
  .profile-info h1 {
    font-size: 1.5rem;
  }
  
  .profile-info .subtitle {
    font-size: 1rem;
  }
  
  .meta-item {
    padding: 0.5rem;
    font-size: 0.875rem;
  }
  
  .form-section-header {
    padding: 1.5rem;
  }
  
  .form-section-header h2 {
    font-size: 1.25rem;
  }
  
  .form-section-body {
    padding: 1rem;
  }
  
  .form-input, .form-textarea {
    padding: 0.875rem 1rem;
    font-size: 0.95rem;
  }
  
  .sidebar-card-header {
    padding: 1rem;
  }
  
  .sidebar-card-body {
    padding: 1rem;
  }
  
  .stat-item {
    padding: 0.75rem 0;
  }
  
  .privacy-setting {
    padding: 1rem 0;
  }
  
  .btn {
    padding: 0.75rem 1rem;
    font-size: 0.9rem;
    min-height: 40px;
  }
}

/* Dark mode support (optional) */
@media (prefers-color-scheme: dark) {
  :root {
    --text-primary: #F9FAFB;
    --text-secondary: #D1D5DB;
    --text-muted: #9CA3AF;
    --bg-primary: #1F2937;
    --bg-secondary: #111827;
    --bg-tertiary: #374151;
    --border-light: #374151;
    --border-medium: #4B5563;
    --border-dark: #6B7280;
  }
}

/* Print styles */
@media print {
  .profile-actions,
  .form-actions,
  .sidebar {
    display: none;
  }
  
  .profile-container {
    max-width: none;
    padding: 0;
  }
  
  .profile-header {
    box-shadow: none;
    border: 1px solid #000;
  }
  
  .profile-form-section {
    box-shadow: none;
    border: 1px solid #000;
  }
}

/* Accessibility improvements */
@media (prefers-reduced-motion: reduce) {
  * {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

/* Focus styles for better accessibility */
.btn:focus,
.form-input:focus,
.form-textarea:focus,
.toggle-switch input:focus + .toggle-slider {
  outline: 2px solid var(--primary-blue);
  outline-offset: 2px;
}

/* High contrast mode support */
@media (prefers-contrast: high) {
  :root {
    --border-light: #000;
    --border-medium: #000;
    --border-dark: #000;
  }
  
  .btn {
    border-width: 2px;
  }
}
</style>
{% endblock %}


<div class="seller-profile-page">
  <div class="profile-container">
  <!-- Alert Messages -->
  {% if messages %}
    {% for message in messages %}
      <div class="alert alert-{{ message.tags }}">
        <svg class="alert-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          {% if message.tags == 'success' %}
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
          {% else %}
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
          {% endif %}
        </svg>
        {{ message }}
      </div>
    {% endfor %}
  {% endif %}

  <!-- Profile Header -->
  <div class="profile-header">
    <div class="profile-header-content">
      <div class="profile-avatar">
        <div class="avatar-container">
          {% if seller.image %}
            <img src="data:image/jpeg;base64,{{ seller.get_image_base64 }}" alt="Profile" class="avatar-image">
          {% else %}
            <div class="avatar-placeholder">ðŸ‘¤</div>
          {% endif %}
        </div>
      </div>
      
      <div class="profile-info">
        <h1>{{ seller.shop_name }}</h1>
        <p class="subtitle">{{ seller.name }}</p>
        
        <div class="profile-meta">
          <div class="meta-item">
            <svg class="meta-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24" width="16" height="16">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>
            </svg>
            <span>{{ seller.email }}</span>
          </div>
          
          <div class="meta-item">
            <svg class="meta-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24" width="16" height="16">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3a2 2 0 012-2h4a2 2 0 012 2v4m-6 0h6l1 12H7L8 7z"></path>
            </svg>
            <span>{{ seller.products.count }} Product{{ seller.products.count|pluralize }}</span>
          </div>
          

          {% if seller.stripe_account_id %}
          <div class="meta-item">
            <svg class="meta-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24" width="16" height="16">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3a2 2 0 012-2h4a2 2 0 012 2v4m-6 0h6l1 12H7L8 7z"></path>
            </svg>
            <span>{{ seller.stripe_account_id }}</span>
          </div>
          {% endif %}
          <div class="meta-item">
            <svg class="meta-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24" width="16" height="16">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3a2 2 0 012-2h4a2 2 0 012 2v4m-6 0h6l1 12H7L8 7z"></path>
            </svg>
            <span>Member since {{ seller.created_at|date:"M Y" }}</span>
          </div>
          
          {% if seller.rating %}
          <div class="meta-item">
            <svg class="meta-icon" fill="currentColor" viewBox="0 0 24 24" width="16" height="16">
              <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"></path>
            </svg>
            <span>{{ seller.rating|floatformat:1 }} Rating</span>
          </div>
          {% endif %}
        </div>
      </div>
      
      <div class="profile-actions">
        <a href="{% url 'stripe_onboard' %}" class="btn btn-secondary" style="width: 160px;" >
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
     stroke-linecap="round" stroke-linejoin="round">
  <path d="M12 12c2.7 0 5-2.3 5-5s-2.3-5-5-5-5 2.3-5 5 2.3 5 5 5z" />
  <path d="M4 21v-1c0-2.8 2.2-5 5-5h6c2.8 0 5 2.2 5 5v1" />
  <polyline points="16 3 21 3 21 8" />
  <line x1="21" y1="3" x2="16" y2="8" />
</svg>Onboarding</a>
        <a href="{% url 'sellers:seller_dashboard' %}" class="btn btn-secondary"style="width: 160px;" >
          <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7h18M3 12h18M3 17h18"></path>
          </svg>
          Dashboard
        </a>
        <a href="{% url 'sellers:products_list' %}" class="btn btn-secondary"style="width: 160px;" ;">View Products</a>
      </div>
    </div>
  </div>

  <!-- Main Content -->
  <div class="main-content">
    <!-- Profile Form -->
    <div class="profile-form-section">
      <div class="form-section-header">
        <h2>Profile Information</h2>
      </div>
      
      <form method="POST" enctype="multipart/form-data" class="profile-form" id="profileForm" action="{% url 'sellers:seller_profile' %}">
        {% csrf_token %}
        <div class="form-section-body">
          
          <!-- Image Upload Section -->
          <div class="image-upload-section" id="imageUploadZone">
            <div class="upload-content">
              <svg width="48" height="48" fill="none" stroke="currentColor" viewBox="0 0 24 24" style="margin: 0 auto 1rem; color: var(--text-muted);">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
              </svg>
              <h3 style="margin: 0 0 0.5rem 0; color: var(--text-primary);">Upload Profile Picture</h3>
              <p style="margin: 0 0 1rem 0; color: var(--text-secondary); font-size: 0.875rem;">
                Drag and drop an image here, or click to select
              </p>
              <input type="file" name="image" id="imageInput" accept="image/*" style="display: none;">
              <button type="button" class="btn btn-secondary" onclick="document.getElementById('imageInput').click()">
                Choose File
              </button>
            </div>
            
            <div class="upload-preview" id="imagePreview" style="display: none;">
              <div class="preview-container">
                <img id="previewImage" class="preview-image" alt="Preview">
                <button type="button" class="remove-preview" onclick="removeImagePreview()">Ã—</button>
              </div>
              <div>
                <p style="margin: 0; font-weight: 500; color: var(--text-primary);">New profile picture</p>
                <p style="margin: 0; font-size: 0.875rem; color: var(--text-secondary);">This will replace your current image</p>
              </div>
            </div>
          </div>

          <!-- Form Fields -->
          <div class="form-grid">
            <div class="form-group">
              <label for="id_name" class="form-label">Full Name *</label>
              <input type="text" name="name" id="id_name" class="form-input" value="{{ seller.name }}" required>
            </div>

            <div class="form-group">
              <label for="id_email" class="form-label">Email Address</label>
              <input type="email" name="email" id="id_email" class="form-input" value="{{ seller.email }}" readonly style="background: var(--neutral-100); cursor: not-allowed;">
              <small style="color: var(--text-secondary); margin-top: 0.25rem; display: block;">Email cannot be changed for security reasons</small>
            </div>

            <div class="form-group">
              <label for="id_shop_name" class="form-label">Shop Name *</label>
              <input type="text" name="shop_name" id="id_shop_name" class="form-input" value="{{ seller.shop_name }}" required>
            </div>



            <div class="form-group full-width">
              <label for="id_shop_description" class="form-label">Shop Description</label>
              <textarea name="shop_description" id="id_shop_description" class="form-input" rows="4" placeholder="Tell customers about your shop...">{{ seller.shop_description|default:'' }}</textarea>
            </div>

            <div class="form-group full-width">
              <label for="id_address" class="form-label">Business Address</label>
              <textarea name="address" id="id_address" class="form-input" rows="2" placeholder="Your business address...">{{ seller.address|default:'' }}</textarea>
            </div>
          </div>

          <div class="form-actions">
            <button type="button" class="btn btn-secondary" onclick="resetForm()">Reset Changes</button>
            <button type="submit" class="btn btn-primary" id="saveButton">
              <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24" style="margin-right: 0.5rem;">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
              </svg>
              Save Changes
            </button>
          </div>
        </div>
      </form>
    </div>

    <!-- Sidebar -->
    <div class="sidebar">
      <!-- Account Statistics -->
      <div class="sidebar-card">
        <div class="sidebar-card-header">
          <h3>Account Statistics</h3>
        </div>
        <div class="sidebar-card-body">
          <div class="stat-item">
            <span class="stat-label">Total Products</span>
            <span class="stat-value">{{ seller.products.count }}</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Account Created</span>
            <span class="stat-value">{{ seller.created_at|date:"M j, Y" }}</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Last Updated</span>
            <span class="stat-value">{{ seller.updated_at|date:"M j, Y" }}</span>
          </div>
          {% if seller.rating %}
          <div class="stat-item">
            <span class="stat-label">Average Rating</span>
            <span class="stat-value">{{ seller.rating|floatformat:1 }}/5.0</span>
          </div>
          {% endif %}
        </div>
      </div>

      <!-- Privacy Settings -->
      

          

      <!-- Quick Actions -->
      <div class="sidebar-card">
        <div class="sidebar-card-header">
          <h3>Quick Actions</h3>
        </div>
        <div class="sidebar-card-body" style="display: flex; flex-direction: column; gap: 0.75rem;">
          <a href="{% url 'sellers:product_create' %}" class="btn btn-primary" style="text-align: center;">
            Add Product
          </a>
          
          <a href="{% url 'sellers:orders_list' %}" class="btn btn-secondary" style="text-align: center;">
            View Orders
          </a>
        </div>
      </div>
    </div>
  </div>
</div>
</div>

<script>
// Form validation and interaction handling
class ProfileManager {
  constructor() {
    this.form = document.getElementById('profileForm');
    this.imageInput = document.getElementById('imageInput');
    this.imageUploadZone = document.getElementById('imageUploadZone');
    this.imagePreview = document.getElementById('imagePreview');
    this.previewImage = document.getElementById('previewImage');
    this.saveButton = document.getElementById('saveButton');
    
    this.init();
  }
  
  init() {
    this.setupImageUpload();
    this.setupFormValidation();
    this.setupDragAndDrop();
    this.trackFormChanges();
  }
  
  setupImageUpload() {
    this.imageInput.addEventListener('change', (e) => {
      this.handleImageSelect(e.target.files[0]);
    });
  }
  
  setupDragAndDrop() {
    ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
      this.imageUploadZone.addEventListener(eventName, this.preventDefaults);
    });
    
    ['dragenter', 'dragover'].forEach(eventName => {
      this.imageUploadZone.addEventListener(eventName, () => {
        this.imageUploadZone.classList.add('drag-over');
      });
    });
    
    ['dragleave', 'drop'].forEach(eventName => {
      this.imageUploadZone.addEventListener(eventName, () => {
        this.imageUploadZone.classList.remove('drag-over');
      });
    });
    
    this.imageUploadZone.addEventListener('drop', (e) => {
      const files = e.dataTransfer.files;
      if (files.length > 0) {
        this.handleImageSelect(files[0]);
      }
    });
  }
  
  preventDefaults(e) {
    e.preventDefault();
    e.stopPropagation();
  }
  
  handleImageSelect(file) {
    if (!file) return;
    
    // Validate file type
    if (!file.type.startsWith('image/')) {
      this.showAlert('Please select a valid image file.', 'error');
      return;
    }
    
    // Validate file size (5MB limit)
    if (file.size > 5 * 1024 * 1024) {
      this.showAlert('Image size must be less than 5MB.', 'error');
      return;
    }
    
    // Show preview
    const reader = new FileReader();
    reader.onload = (e) => {
      this.previewImage.src = e.target.result;
      this.imagePreview.style.display = 'flex';
    };
    reader.readAsDataURL(file);
  }
  
  setupFormValidation() {
    const requiredFields = this.form.querySelectorAll('input[required]');
    
    requiredFields.forEach(field => {
      field.addEventListener('blur', () => this.validateField(field));
      field.addEventListener('input', debounce(() => this.validateField(field), 300));
    });
    
    this.form.addEventListener('submit', (e) => {
      e.preventDefault();
      this.handleSubmit();
    });
  }
  
  validateField(field) {
    const value = field.value.trim();
    let isValid = true;
    let message = '';
    
    if (field.hasAttribute('required') && !value) {
      isValid = false;
      message = 'This field is required.';
    } else if (field.type === 'email' && value && !this.isValidEmail(value)) {
      isValid = false;
      message = 'Please enter a valid email address.';
    }
    
    this.updateFieldState(field, isValid, message);
    return isValid;
  }
  
  isValidEmail(email) {
    const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    return emailPattern.test(email);
  }
  
  updateFieldState(field, isValid, message) {
    const existingError = field.parentElement.querySelector('.form-error');
    
    if (isValid) {
      field.classList.remove('invalid');
      if (existingError) existingError.remove();
    } else {
      field.classList.add('invalid');
      if (!existingError) {
        const errorDiv = document.createElement('div');
        errorDiv.className = 'form-error';
        errorDiv.textContent = message;
        field.parentElement.appendChild(errorDiv);
      } else {
        existingError.textContent = message;
      }
    }
  }
  
  trackFormChanges() {
    const formElements = this.form.querySelectorAll('input, textarea, select');
    const originalValues = new Map();
    
    // Store original values
    formElements.forEach(element => {
      originalValues.set(element.name, element.value);
    });
    
    // Track changes
    formElements.forEach(element => {
      element.addEventListener('input', () => {
        const hasChanges = Array.from(formElements).some(el => 
          originalValues.get(el.name) !== el.value
        );
        
        if (hasChanges) {
          this.saveButton.classList.add('btn-primary');
          this.saveButton.classList.remove('btn-secondary');
        } else {
          this.saveButton.classList.add('btn-secondary');
          this.saveButton.classList.remove('btn-primary');
        }
      });
    });
  }
  
  async handleSubmit() {
    // Validate all required fields
    const requiredFields = this.form.querySelectorAll('input[required]');
    let isFormValid = true;
    
    requiredFields.forEach(field => {
      if (!this.validateField(field)) {
        isFormValid = false;
      }
    });
    
    if (!isFormValid) {
      this.showAlert('Please fix the errors before submitting.', 'error');
      return;
    }
    
    // Show loading state
    this.setLoadingState(true);
    
    try {
      // Create FormData for file upload
      const formData = new FormData(this.form);
      
      // Submit form
      const response = await fetch(this.form.action || window.location.href, {
        method: 'POST',
        body: formData,
        headers: {
          'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value
        }
      });
      
      if (response.ok) {
        this.showAlert('Profile updated successfully!', 'success');
        // Reload page to show updated data
        setTimeout(() => window.location.reload(), 1500);
      } else {
        throw new Error('Failed to update profile');
      }
    } catch (error) {
      this.showAlert('An error occurred while updating your profile. Please try again.', 'error');
    } finally {
      this.setLoadingState(false);
    }
  }
  
  setLoadingState(loading) {
    if (loading) {
      this.saveButton.classList.add('loading');
      this.saveButton.disabled = true;
    } else {
      this.saveButton.classList.remove('loading');
      this.saveButton.disabled = false;
    }
  }
  
  showAlert(message, type) {
    // Remove existing alerts
    const existingAlerts = document.querySelectorAll('.alert');
    existingAlerts.forEach(alert => alert.remove());
    
    // Create new alert
    const alertDiv = document.createElement('div');
    alertDiv.className = `alert alert-${type}`;
    
    const icon = type === 'success' 
      ? '<svg class="alert-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>'
      : '<svg class="alert-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>';
    
    alertDiv.innerHTML = `${icon} ${message}`;
    
    // Insert at top of container
    const container = document.querySelector('.profile-container');
    container.insertBefore(alertDiv, container.firstChild);
    
    // Auto-remove after 5 seconds
    setTimeout(() => alertDiv.remove(), 5000);
    
    // Smooth scroll to top
    window.scrollTo({ top: 0, behavior: 'smooth' });
  }
}

// Global functions for template usage
function removeImagePreview() {
  const imagePreview = document.getElementById('imagePreview');
  const imageInput = document.getElementById('imageInput');
  
  imagePreview.style.display = 'none';
  imageInput.value = '';
}

function resetForm() {
  const form = document.getElementById('profileForm');
  
  // Show confirmation dialog
  if (confirm('Are you sure you want to reset all changes? This will undo any unsaved modifications.')) {
    form.reset();
    removeImagePreview();
    
    // Remove any error states
    const errorElements = form.querySelectorAll('.form-error');
    errorElements.forEach(error => error.remove());
    
    const invalidFields = form.querySelectorAll('.invalid');
    invalidFields.forEach(field => field.classList.remove('invalid'));
    
    // Reset save button state
    const saveButton = document.getElementById('saveButton');
    saveButton.classList.add('btn-secondary');
    saveButton.classList.remove('btn-primary');
  }
}

// Privacy settings handlers
function handlePrivacyToggle(toggleId) {
  const toggle = document.getElementById(toggleId);
  const isEnabled = toggle.checked;
  
  // Here you would typically send an AJAX request to update the setting
  console.log(`${toggleId} toggled to: ${isEnabled}`);
  
  // Show feedback
  const profileManager = window.profileManager;
  if (profileManager) {
    profileManager.showAlert(
      `Privacy setting updated: ${toggleId.replace(/([A-Z])/g, ' $1').toLowerCase()}`,
      'success'
    );
  }
}

// Utility functions
const debounce = (func, wait) => {
  let timeout;
  return function executedFunction(...args) {
    const later = () => {
      clearTimeout(timeout);
      func(...args);
    };
    clearTimeout(timeout);
    timeout = setTimeout(later, wait);
  };
};

// Initialize when DOM is ready
document.addEventListener('DOMContentLoaded', function() {
  // Initialize profile manager
  window.profileManager = new ProfileManager();
  
  // Setup privacy toggle handlers
  const privacyToggles = ['showContact', 'publicProfile', 'emailNotifications'];
  privacyToggles.forEach(toggleId => {
    const toggle = document.getElementById(toggleId);
    if (toggle) {
      toggle.addEventListener('change', () => handlePrivacyToggle(toggleId));
    }
  });
  
  // Setup keyboard shortcuts
  document.addEventListener('keydown', function(e) {
    // Ctrl/Cmd + S to save form
    if ((e.ctrlKey || e.metaKey) && e.key === 's') {
      e.preventDefault();
      const profileForm = document.getElementById('profileForm');
      if (profileForm) {
        window.profileManager.handleSubmit();
      }
    }
    
    // Escape to reset form
    if (e.key === 'Escape') {
      const activeElement = document.activeElement;
      if (activeElement && activeElement.tagName !== 'BUTTON') {
        activeElement.blur();
      }
    }
  });
  
  // Auto-save draft functionality (optional)
  const autoSaveInterval = setInterval(() => {
    const form = document.getElementById('profileForm');
    if (form) {
      const formData = new FormData(form);
      const draftData = {};
      
      for (let [key, value] of formData.entries()) {
        if (key !== 'csrfmiddlewaretoken' && key !== 'image') {
          draftData[key] = value;
        }
      }
      
      // Save to localStorage as draft
      localStorage.setItem('profileDraft', JSON.stringify(draftData));
    }
  }, 30000); // Auto-save every 30 seconds
  
  // Load draft on page load
  const savedDraft = localStorage.getItem('profileDraft');
  if (savedDraft) {
    try {
      const draftData = JSON.parse(savedDraft);
      let hasUnsavedChanges = false;
      
      Object.entries(draftData).forEach(([key, value]) => {
        const field = document.querySelector(`[name="${key}"]`);
        if (field && field.value !== value) {
          hasUnsavedChanges = true;
        }
      });
      
      if (hasUnsavedChanges) {
        const restoreDraft = confirm('We found unsaved changes from a previous session. Would you like to restore them?');
        if (restoreDraft) {
          Object.entries(draftData).forEach(([key, value]) => {
            const field = document.querySelector(`[name="${key}"]`);
            if (field) {
              field.value = value;
            }
          });
        }
      }
    } catch (e) {
      // Invalid draft data, remove it
      localStorage.removeItem('profileDraft');
    }
  }
  
  // Clear draft when form is successfully submitted
  window.addEventListener('beforeunload', () => {
    localStorage.removeItem('profileDraft');
  });
});

// Lazy loading for images
const imageObserver = new IntersectionObserver((entries) => {
  entries.forEach(entry => {
    if (entry.isIntersecting) {
      const img = entry.target;
      if (img.dataset.src) {
        img.src = img.dataset.src;
        img.classList.remove('lazy');
        imageObserver.unobserve(img);
      }
    }
  });
});

// Observe all lazy images
document.querySelectorAll('img.lazy').forEach(img => {
  imageObserver.observe(img);
});
</script>
{% endblock %}